# Diagnostic Pre-training Configuration
# Simplified single-dimension training for diagnosing issues

data:
  # Annotation paths - COLAB MYDRIVE PATHS
  train_path: /content/drive/MyDrive/crescendai_data/maestro_pseudo_labels_train.jsonl
  val_path: /content/drive/MyDrive/crescendai_data/maestro_pseudo_labels_val.jsonl
  test_path: null

  dimensions:
    - note_accuracy

  batch_size: 8
  num_workers: 4
  audio_sample_rate: 24000
  max_audio_length: 240000
  max_midi_events: 512
  augmentation: null

model:
  audio_dim: 768
  midi_dim: 256
  fusion_dim: 1024
  aggregator_dim: 512
  num_dimensions: 1
  mert_model_name: m-a-p/MERT-v1-95M
  freeze_audio_encoder: false
  gradient_checkpointing: true

training:
  max_epochs: 5
  precision: 16
  learning_rate: 1e-4
  backbone_lr: 2e-5
  heads_lr: 2e-4
  weight_decay: 0.01
  gradient_clip_val: 1.0
  warmup_steps: 100
  accumulate_grad_batches: 2
  val_check_interval: 0.5
  limit_val_batches: 1.0

callbacks:
  checkpoint:
    monitor: val_loss
    mode: min
    save_top_k: 2
    save_last: true
    dirpath: checkpoints/diagnostic_pretrain
    filename: epoch{epoch:02d}-val_loss{val_loss:.2f}
  early_stopping:
    monitor: val_loss
    mode: min
    patience: 3
    min_delta: 0.01
  lr_monitor:
    logging_interval: step

logging:
  use_tensorboard: true
  tensorboard_logdir: logs/diagnostic_pretrain
  log_every_n_steps: 10
  use_wandb: false
  wandb_project: piano-eval-diagnostic
  wandb_entity: null
  wandb_run_name: diagnostic-single-dim

seed: 42
